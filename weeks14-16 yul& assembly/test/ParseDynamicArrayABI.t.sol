// SPDX-License-Identifier: MIT
pragma solidity >=0.8.0;

import "forge-std/Test.sol";
import "./lib/YulDeployer.sol";

interface Example {}

contract ParseDynamicArrayABITest is Test {
    YulDeployer yulDeployer = new YulDeployer();

    Example exampleContract;

    function setUp() public {
        exampleContract = Example(yulDeployer.deployContract("yul/yulComponents/", "ParseDynamicArrayABI"));
    }

    function testParseDynamicArrayABI() public {
        uint256[] memory array = new uint256[](3);
        array[0] = 1;
        array[1] = 2;
        array[2] = 3;

        bytes memory callDataBytes = abi.encodeWithSignature("parse(uint256[],uint256[])", array, array);
        // bytes memory callDataBytes = abi.encode("uint256[]", array);
        console.logBytes(callDataBytes);

        (bool success, bytes memory data) = address(exampleContract).call(callDataBytes);
        (uint256 x, uint256 y, uint256 z) = abi.decode(data, (uint256, uint256, uint256));
        console.logString("--------------------------------");
        console.logBool(success);
        console.logBytes(data);
        console.log(x);
        console.log(y);
        console.log(z);
        // assertEq(x, 1);
        // assertEq(y, 2);
        // assertTrue(success);
        // assertEq(data, callDataBytes);
    }
}

// 0000000000000000000000000000000000000000000000000000000000000020 0x00
// 0000000000000000000000000000000000000000000000000000000000000003 0x20
// 0000000000000000000000000000000000000000000000000000000000000001 0x40
// 0000000000000000000000000000000000000000000000000000000000000002 0x60
// 0000000000000000000000000000000000000000000000000000000000000003 0x80

// 9d2085ed
// 0000000000000000000000000000000000000000000000000000000000000040 0x00
// 00000000000000000000000000000000000000000000000000000000000000c0 0x20
// 0000000000000000000000000000000000000000000000000000000000000003 0x40
// 0000000000000000000000000000000000000000000000000000000000000001 0x60
// 0000000000000000000000000000000000000000000000000000000000000002 0x80
// 0000000000000000000000000000000000000000000000000000000000000003 0xa0
// 0000000000000000000000000000000000000000000000000000000000000003 0xc0
// 0000000000000000000000000000000000000000000000000000000000000001 0xe0
// 0000000000000000000000000000000000000000000000000000000000000002 0x0100
// 0000000000000000000000000000000000000000000000000000000000000003 0x0120

// 0x9d2085ed
// 0000000000000000000000000000000000000000000000000000000000000040
// 00000000000000000000000000000000000000000000000000000000000000c0
// 0000000000000000000000000000000000000000000000000000000000000003
// 0000000000000000000000000000000000000000000000000000000000000001
// 0000000000000000000000000000000000000000000000000000000000000002
// 0000000000000000000000000000000000000000000000000000000000000003
// 0000000000000000000000000000000000000000000000000000000000000003
// 0000000000000000000000000000000000000000000000000000000000000001
// 0000000000000000000000000000000000000000000000000000000000000002
// 0000000000000000000000000000000000000000000000000000000000000003

//0000000000000000000000000000000000000000000000000000000000000044
//0000000000000000000000000000000000000000000000000000000000000005
//0000000000000000000000000000000000000000000000000000000000000144
//0000000000000000000000000000000000000000000000000000000000000000
//0000000000000000000000000000000000000000000000000000000000000000
//0000000000000000000000000000000000000000000000000000000000000000

//c3d462fa
//0000000000000000000000000000000000000000000000000000000000000040 // 0x00
//0000000000000000000000000000000000000000000000000000000000000100 // 0x20
//0000000000000000000000000000000000000000000000000000000000000005 // 0x40
//0000000000000000000000000000000000000000000000000000000000000005 // 0x60
//000000000000000000000000000000000000000000000000000000000000beef // 0x80
//000000000000000000000000000000000000000000000000000000000000cafe // 0xa0
//000000000000000000000000000000000000000000000000000000000000face // 0xc0
//000000000000000000000000000000000000000000000000000000000000dead // 0xe0
//000000000000000000000000000000000000000000000000000000000000feed // 0x100
//0000000000000000000000000000000000000000000000000000000000000005 // 0x120
//0000000000000000000000000000000000000000000000000000000000000539 // 0x140
//000000000000000000000000000000000000000000000000000000000000053a // 0x160
//000000000000000000000000000000000000000000000000000000000000053b // 0x180
//000000000000000000000000000000000000000000000000000000000000053c // 0x1a0
//000000000000000000000000000000000000000000000000000000000000053d // 0x1c0

//0000000000000000000000000000000000000000000000000000000000000044
//0000000000000000000000000000000000000000000000000000000000000005
//0000000000000000000000000000000000000000000000000000000000000144
//0000000000000000000000000000000000000000000000000000000000000000
// 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

//0000000000000000000000000000000000000000000000000000000000000040
//0000010000000000000000000000000000000000000000000000000000000000
//0000000000000000000000000000000000000000000000000000000000000140
//0000000000000000000000000000000000000000000000000000000000000000
//0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

//0000000000000000000000000000000000000000000000000000000000000044
//0000000000000000000000000000000000000000000000000000000000000005
//0000000000000000000000000000000000000000000000000000000000000144
//00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

//f23a6e61
//0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496 // 0x00
//000000000000000000000000000000000000000000000000000000000000abcd // 0x20
//0000000000000000000000000000000000000000000000000000000000000539 // 0x40
//0000000000000000000000000000000000000000000000000000000000000046 // 0x60
//00000000000000000000000000000000000000000000000000000000000000a0 // 0x80
//0000000000000000000000000000000000000000000000000000000000000000 // 0xa0

//0xf23a6e61
//0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496
//0000000000000000000000000000000000000000000000000000000000000000
//0000000000000000000000000000000000000000000000000000000000000539
//0000000000000000000000000000000000000000000000000000000000000046
//00000000000000000000000000000000000000000000000000000000000000a0
//0000000000000000000000000000000000000000000000000000000000000000
//00000000000000000000000000000000000000000000000000000000

//0xf23a6e61
//0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496
//000000000000000000000000000000000000000000000000000000000000abcd
//0000000000000000000000000000000000000000000000000000000000000539
//0000000000000000000000000000000000000000000000000000000000000046
//00000000000000000000000000000000000000000000000000000000000000a0
//0000000000000000000000000000000000000000000000000000000000000004
//7468697300000000000000000000000000000000000000000000000000000000

//0xf23a6e61
//0000000000000000000000007fa9385be102ac3eac297483dd6233d62b3e1496
//000000000000000000000000000000000000000000000000000000000000abcd
//0000000000000000000000000000000000000000000000000000000000000539
//0000000000000000000000000000000000000000000000000000000000000046
//00000000000000000000000000000000000000000000000000000000000000a0
//00000000000000000000000000000000000000000000000000000000000000a6
//74657374696e6720313233206c6f6e67657220737472696e6720746861742073
//686f756c64206265207472756e636174656420666f7220746865206461746120
//617267756d656e7420666f722074686520736166655472616e7366657246726f
//6d2066756e6374696f6e20666f7220746865206f6e4552433131353552656365
//697665642066756e6374696f6e20666f722074686520455243313135352e7975
//6c2066696c650000000000000000000000000000000000000000000000000000
